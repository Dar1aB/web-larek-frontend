(()=>{"use strict";function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===_typeof(i)?i:String(i)),n)}var o,i}var e=function(){function Api(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Api),this.baseUrl=e,this.options={headers:Object.assign({"Content-Type":"application/json"},null!==(t=r.headers)&&void 0!==t?t:{})}}return function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(Api,[{key:"handleResponse",value:function handleResponse(e){return e.ok?e.json():e.json().then((function(t){var r;return Promise.reject(null!==(r=t.error)&&void 0!==r?r:e.statusText)}))}},{key:"get",value:function get(e){return fetch(this.baseUrl+e,Object.assign(Object.assign({},this.options),{method:"GET"})).then(this.handleResponse)}},{key:"post",value:function post(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"POST";return fetch(this.baseUrl+e,Object.assign(Object.assign({},this.options),{method:r,body:JSON.stringify(t)})).then(this.handleResponse)}}]),Api}();function events_typeof(e){return events_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},events_typeof(e)}function events_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function events_toPrimitive(e,t){if("object"!==events_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==events_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===events_typeof(i)?i:String(i)),n)}var o,i}var t=function(){function EventEmitter(){!function events_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,EventEmitter),this._events=new Map}return function events_createClass(e,t,r){return t&&events_defineProperties(e.prototype,t),r&&events_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(EventEmitter,[{key:"on",value:function on(e,t){var r;this._events.has(e)||this._events.set(e,new Set),null===(r=this._events.get(e))||void 0===r||r.add(t)}},{key:"off",value:function off(e,t){var r;this._events.has(e)&&(this._events.get(e).delete(t),0===(null===(r=this._events.get(e))||void 0===r?void 0:r.size)&&this._events.delete(e))}},{key:"emit",value:function emit(e,t){this._events.forEach((function(r,n){"*"===n&&r.forEach((function(r){return r({eventName:e,data:t})})),(n instanceof RegExp&&n.test(e)||n===e)&&r.forEach((function(e){return e(t)}))}))}},{key:"onAll",value:function onAll(e){this.on("*",e)}},{key:"offAll",value:function offAll(){this._events=new Map}},{key:"trigger",value:function trigger(e,t){var r=this;return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r.emit(e,Object.assign(Object.assign({},n||{}),t||{}))}}}]),EventEmitter}();function AppStatus_typeof(e){return AppStatus_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},AppStatus_typeof(e)}function _toConsumableArray(e){return function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}(e)||function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function _unsupportedIterableToArray(e,t){if(!e)return;if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray(e,t)}(e)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function AppStatus_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function AppStatus_toPrimitive(e,t){if("object"!==AppStatus_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==AppStatus_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===AppStatus_typeof(i)?i:String(i)),n)}var o,i}var r=function(){function AppStatus(e){!function AppStatus_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,AppStatus),this.events=e,this._catalog=[],this._basket=[],this._order={payment:"card",email:"",phone:"",address:""}}return function AppStatus_createClass(e,t,r){return t&&AppStatus_defineProperties(e.prototype,t),r&&AppStatus_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(AppStatus,[{key:"getCatalog",value:function getCatalog(){return _toConsumableArray(this._catalog)}},{key:"getBasket",value:function getBasket(){return _toConsumableArray(this._basket)}},{key:"getOrder",value:function getOrder(){return Object.assign({},this._order)}},{key:"getPaidItems",value:function getPaidItems(){return this._basket.filter((function(e){return null!==e.price}))}},{key:"hasOnlyFreeItems",value:function hasOnlyFreeItems(){return this._basket.every((function(e){return null===e.price}))}},{key:"setCatalog",value:function setCatalog(e){this._catalog=e,this.events.emit("catalog:changed",this._catalog)}},{key:"hasNoItems",value:function hasNoItems(){return 0===this._basket.length}},{key:"setOrderFormField",value:function setOrderFormField(e,t){this._order[e]=t,this.events.emit("order:changed",{field:e,value:t})}},{key:"addToBasket",value:function addToBasket(e){var t=this._catalog.find((function(t){return t.id===e.id}));t&&(this._basket.some((function(t){return t.id===e.id}))||(this._basket.push(Object.assign({},t)),this.events.emit("basket:changed")))}},{key:"delFromBasket",value:function delFromBasket(e){this._basket=this._basket.filter((function(t){return t.id!==e})),this.events.emit("basket:changed")}},{key:"clearBasket",value:function clearBasket(){this._basket=[],this.events.emit("basket:changed")}},{key:"getTotal",value:function getTotal(){return this._basket.filter((function(e){return null!==e.price})).reduce((function(e,t){return e+(t.price||0)}),0)}},{key:"validateOrder",value:function validateOrder(e){var t=this.getOrder();if("payment"===e){var r=Boolean(t.address);return{isValid:r,errors:r?"":"Необходимо указать адрес"}}if("contacts"===e){var n=Boolean(t.email),o=Boolean(t.phone);return n||o?n?o?{isValid:!0,errors:""}:{isValid:!1,errors:"Необходимо указать телефон"}:{isValid:!1,errors:"Необходимо указать email"}:{isValid:!1,errors:"Необходимо указать email и телефон"}}return{isValid:!1,errors:""}}}]),AppStatus}();function isSelector(e){return"string"==typeof e&&e.length>1}function ensureAllElements(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;if(isSelector(e))return Array.from(t.querySelectorAll(e));if(e instanceof NodeList)return Array.from(e);if(Array.isArray(e))return e;throw new Error("Unknown selector element")}function ensureElement(e,t){if(isSelector(e)){var r=ensureAllElements(e,t);if(r.length>1&&console.warn("selector ".concat(e," return more then one element")),0===r.length)throw new Error("selector ".concat(e," return nothing"));return r.pop()}if(e instanceof HTMLElement)return e;throw new Error("Unknown selector element")}function cloneTemplate(e){return ensureElement(e).content.firstElementChild.cloneNode(!0)}function component_typeof(e){return component_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},component_typeof(e)}function component_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function component_toPrimitive(e,t){if("object"!==component_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==component_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===component_typeof(i)?i:String(i)),n)}var o,i}var n=function(){function Component(e){!function component_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Component),this.container=e}return function component_createClass(e,t,r){return t&&component_defineProperties(e.prototype,t),r&&component_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(Component,[{key:"setText",value:function setText(e,t){e&&(e.textContent=t)}},{key:"toggleClassName",value:function toggleClassName(e,t,r){e.classList.toggle(t,r)}},{key:"setDisable",value:function setDisable(e,t){e.toggleAttribute("disabled",t)}}]),Component}();function Basket_typeof(e){return Basket_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Basket_typeof(e)}function Basket_toConsumableArray(e){return function Basket_arrayWithoutHoles(e){if(Array.isArray(e))return Basket_arrayLikeToArray(e)}(e)||function Basket_iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function Basket_unsupportedIterableToArray(e,t){if(!e)return;if("string"==typeof e)return Basket_arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Basket_arrayLikeToArray(e,t)}(e)||function Basket_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Basket_arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Basket_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function Basket_toPrimitive(e,t){if("object"!==Basket_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==Basket_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===Basket_typeof(i)?i:String(i)),n)}var o,i}function _setPrototypeOf(e,t){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e},_setPrototypeOf(e,t)}function _createSuper(e){var t=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var r,n=_getPrototypeOf(e);if(t){var o=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function _possibleConstructorReturn(e,t){if(t&&("object"===Basket_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function _getPrototypeOf(e){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(e)}var o=function(e){!function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}(Basket,e);var t=_createSuper(Basket);function Basket(e,r){var n;return function Basket_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Basket),(n=t.call(this,e)).events=r,n._list=ensureElement(".basket__list",n.container),n._total=ensureElement(".basket__price",n.container),n._button=ensureElement(".basket__button",n.container),n._empty=ensureElement(".basket__empty",n.container),n._button.addEventListener("click",(function(){r.emit("order:open",{})})),n}return function Basket_createClass(e,t,r){return t&&Basket_defineProperties(e.prototype,t),r&&Basket_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(Basket,[{key:"items",set:function set(e){var t;(t=this._list).replaceChildren.apply(t,Basket_toConsumableArray(e)),this.isEmpty=0===e.length}},{key:"total",set:function set(e){this.setText(this._total,"".concat(e," синапсов"))}},{key:"isEmpty",set:function set(e){this.setDisable(this._button,e),this._empty.style.display=e?"block":"none"}},{key:"hasOnlyFreeItems",set:function set(e){this.setDisable(this._button,e)}},{key:"render",value:function render(e){return e&&(e.items&&(this.items=e.items),e.total&&(this.total=e.total),void 0!==e.isEmpty&&(this.isEmpty=e.isEmpty),void 0!==e.hasOnlyFreeItems&&(this.hasOnlyFreeItems=e.hasOnlyFreeItems)),this.container}}]),Basket}(n);function Card_typeof(e){return Card_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Card_typeof(e)}function Card_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function Card_toPrimitive(e,t){if("object"!==Card_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==Card_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===Card_typeof(i)?i:String(i)),n)}var o,i}function Card_setPrototypeOf(e,t){return Card_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e},Card_setPrototypeOf(e,t)}function Card_createSuper(e){var t=function Card_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var r,n=Card_getPrototypeOf(e);if(t){var o=Card_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function Card_possibleConstructorReturn(e,t){if(t&&("object"===Card_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function Card_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function Card_getPrototypeOf(e){return Card_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)},Card_getPrototypeOf(e)}var i=function(e){!function Card_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Card_setPrototypeOf(e,t)}(Card,e);var t=Card_createSuper(Card);function Card(e,r){var n;return function Card_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Card),n=t.call(this,e),(null==r?void 0:r.onClick)&&n.container.addEventListener("click",(function(e){e.target.closest(".card__button")||r.onClick()})),n._title=ensureElement(".card__title",n.container),n._price=ensureElement(".card__price",n.container),n._button=n.container.querySelector(".card__button"),n._category=n.container.querySelector(".card__category"),n._image=n.container.querySelector(".card__image"),n._description=n.container.querySelector(".card__text"),n._button&&(null==r?void 0:r.onClick)&&n._button.addEventListener("click",r.onClick),n}return function Card_createClass(e,t,r){return t&&Card_defineProperties(e.prototype,t),r&&Card_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(Card,[{key:"title",set:function set(e){this.setText(this._title,e)}},{key:"price",set:function set(e){var t=e?"".concat(e," синапсов"):"Бесценно";this.setText(this._price,t),this._button&&this.setDisable(this._button,!1)}},{key:"category",set:function set(e){if(this._category){this.setText(this._category,e);var t={"софт-скил":"soft",другое:"other",дополнительное:"additional",кнопка:"button","хард-скил":"hard"}[e.toLowerCase()]||"other";this._category.className="card__category card__category_".concat(t)}}},{key:"image",set:function set(e){this._image&&(this._image.src="https://larek-api.nomoreparties.co/content/weblarek"+e,this._image.alt=this._title.textContent||"")}},{key:"inBasket",set:function set(e){this._button&&this.setText(this._button,e?"Удалить из корзины":"Купить")}},{key:"description",set:function set(e){this._description&&this.setText(this._description,e)}},{key:"render",value:function render(e){return e&&(e.title&&(this.title=e.title),void 0!==e.price&&(this.price=e.price),e.category&&(this.category=e.category),e.image&&(this.image=e.image),void 0!==e.inBasket&&(this.inBasket=e.inBasket),e.description&&(this.description=e.description)),this.container}}]),Card}(n);function Modal_typeof(e){return Modal_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Modal_typeof(e)}function Modal_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function Modal_toPrimitive(e,t){if("object"!==Modal_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==Modal_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===Modal_typeof(i)?i:String(i)),n)}var o,i}function Modal_setPrototypeOf(e,t){return Modal_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e},Modal_setPrototypeOf(e,t)}function Modal_createSuper(e){var t=function Modal_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var r,n=Modal_getPrototypeOf(e);if(t){var o=Modal_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function Modal_possibleConstructorReturn(e,t){if(t&&("object"===Modal_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function Modal_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function Modal_getPrototypeOf(e){return Modal_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)},Modal_getPrototypeOf(e)}var a=function(e){!function Modal_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Modal_setPrototypeOf(e,t)}(Modal,e);var t=Modal_createSuper(Modal);function Modal(e,r){var n;return function Modal_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Modal),(n=t.call(this,e)).events=r,n._content=ensureElement(".modal__content",n.container),n._closeBtn=ensureElement(".modal__close",n.container),n._closeBtn.addEventListener("click",(function(){return n.events.emit("modal:close")})),n.container.addEventListener("click",(function(e){e.target===n.container&&n.events.emit("modal:close")})),n}return function Modal_createClass(e,t,r){return t&&Modal_defineProperties(e.prototype,t),r&&Modal_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(Modal,[{key:"content",set:function set(e){this._content.replaceChildren(e)}},{key:"open",value:function open(){this.container.classList.add("modal_active")}},{key:"close",value:function close(){this.container.classList.remove("modal_active")}},{key:"render",value:function render(e){return(null==e?void 0:e.content)&&(this.content=e.content),this.container}}]),Modal}(n);function Page_typeof(e){return Page_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Page_typeof(e)}function Page_toConsumableArray(e){return function Page_arrayWithoutHoles(e){if(Array.isArray(e))return Page_arrayLikeToArray(e)}(e)||function Page_iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function Page_unsupportedIterableToArray(e,t){if(!e)return;if("string"==typeof e)return Page_arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Page_arrayLikeToArray(e,t)}(e)||function Page_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Page_arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Page_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function Page_toPrimitive(e,t){if("object"!==Page_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==Page_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===Page_typeof(i)?i:String(i)),n)}var o,i}function Page_setPrototypeOf(e,t){return Page_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e},Page_setPrototypeOf(e,t)}function Page_createSuper(e){var t=function Page_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var r,n=Page_getPrototypeOf(e);if(t){var o=Page_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function Page_possibleConstructorReturn(e,t){if(t&&("object"===Page_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function Page_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function Page_getPrototypeOf(e){return Page_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)},Page_getPrototypeOf(e)}var s=function(e){!function Page_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Page_setPrototypeOf(e,t)}(Page,e);var t=Page_createSuper(Page);function Page(e,r){var n;!function Page_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Page),(n=t.call(this,e)).events=r,n._gallery=ensureElement(".gallery",n.container),n._counter=ensureElement(".header__basket-counter",n.container),n._wrapper=ensureElement(".page__wrapper",n.container);var o=ensureElement("#modal-container",n.container);return n._modal=new a(o,r),ensureElement(".header__basket",n.container).addEventListener("click",(function(){r.emit("basket:open")})),n}return function Page_createClass(e,t,r){return t&&Page_defineProperties(e.prototype,t),r&&Page_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(Page,[{key:"catalog",set:function set(e){var t;(t=this._gallery).replaceChildren.apply(t,Page_toConsumableArray(e))}},{key:"counter",set:function set(e){this.setText(this._counter,String(e))}},{key:"locked",set:function set(e){this.toggleClassName(this._wrapper,"page__wrapper_locked",e)}},{key:"renderModalOpen",value:function renderModalOpen(e){this._modal.render({content:e}),this._modal.open()}},{key:"modalClose",value:function modalClose(){this._modal.close()}},{key:"render",value:function render(){return this.container}}]),Page}(n);function BasketItem_typeof(e){return BasketItem_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},BasketItem_typeof(e)}function BasketItem_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function BasketItem_toPrimitive(e,t){if("object"!==BasketItem_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==BasketItem_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===BasketItem_typeof(i)?i:String(i)),n)}var o,i}function BasketItem_setPrototypeOf(e,t){return BasketItem_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e},BasketItem_setPrototypeOf(e,t)}function BasketItem_createSuper(e){var t=function BasketItem_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var r,n=BasketItem_getPrototypeOf(e);if(t){var o=BasketItem_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function BasketItem_possibleConstructorReturn(e,t){if(t&&("object"===BasketItem_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function BasketItem_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function BasketItem_getPrototypeOf(e){return BasketItem_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)},BasketItem_getPrototypeOf(e)}var c=function(e){!function BasketItem_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BasketItem_setPrototypeOf(e,t)}(BasketItem,e);var t=BasketItem_createSuper(BasketItem);function BasketItem(e,r){var n;return function BasketItem_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BasketItem),(n=t.call(this,e)).events=r,n._index=ensureElement(".basket__item-index",n.container),n._title=ensureElement(".card__title",n.container),n._price=ensureElement(".card__price",n.container),n._delBtn=ensureElement(".basket__item-delete",n.container),n._delBtn.addEventListener("click",(function(){r.emit("basket:remove",{id:n._delBtn.dataset.id||""})})),n}return function BasketItem_createClass(e,t,r){return t&&BasketItem_defineProperties(e.prototype,t),r&&BasketItem_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(BasketItem,[{key:"index",set:function set(e){this.setText(this._index,e.toString())}},{key:"title",set:function set(e){this.setText(this._title,e)}},{key:"price",set:function set(e){this.setText(this._price,e?"".concat(e," синапсов"):"Бесценно")}},{key:"render",value:function render(e){return e&&(void 0!==e.index&&(this.index=e.index),e.title&&(this.title=e.title),void 0!==e.price&&(this.price=e.price),e.id&&(this._delBtn.dataset.id=e.id)),this.container}}]),BasketItem}(n);function Success_typeof(e){return Success_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Success_typeof(e)}function Success_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function Success_toPrimitive(e,t){if("object"!==Success_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==Success_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===Success_typeof(i)?i:String(i)),n)}var o,i}function Success_setPrototypeOf(e,t){return Success_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e},Success_setPrototypeOf(e,t)}function Success_createSuper(e){var t=function Success_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var r,n=Success_getPrototypeOf(e);if(t){var o=Success_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function Success_possibleConstructorReturn(e,t){if(t&&("object"===Success_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function Success_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function Success_getPrototypeOf(e){return Success_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)},Success_getPrototypeOf(e)}var u=function(e){!function Success_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Success_setPrototypeOf(e,t)}(Success,e);var t=Success_createSuper(Success);function Success(e,r){var n;return function Success_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Success),(n=t.call(this,e)).events=r,n._description=ensureElement(".order-success__description",n.container),n._closeBtn=ensureElement(".order-success__close",n.container),n._closeBtn.addEventListener("click",(function(){n.events.emit("modal:close")})),n}return function Success_createClass(e,t,r){return t&&Success_defineProperties(e.prototype,t),r&&Success_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(Success,[{key:"total",set:function set(e){this._description.textContent="Списано ".concat(e," синапсов")}},{key:"render",value:function render(e){return void 0!==(null==e?void 0:e.total)&&(this.total=e.total),this.container}}]),Success}(n);function OrderForm_typeof(e){return OrderForm_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},OrderForm_typeof(e)}function OrderForm_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function OrderForm_toPrimitive(e,t){if("object"!==OrderForm_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==OrderForm_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===OrderForm_typeof(i)?i:String(i)),n)}var o,i}function OrderForm_setPrototypeOf(e,t){return OrderForm_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e},OrderForm_setPrototypeOf(e,t)}function OrderForm_createSuper(e){var t=function OrderForm_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var r,n=OrderForm_getPrototypeOf(e);if(t){var o=OrderForm_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function OrderForm_possibleConstructorReturn(e,t){if(t&&("object"===OrderForm_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function OrderForm_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function OrderForm_getPrototypeOf(e){return OrderForm_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)},OrderForm_getPrototypeOf(e)}var l=function(e){!function OrderForm_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&OrderForm_setPrototypeOf(e,t)}(OrderForm,e);var t=OrderForm_createSuper(OrderForm);function OrderForm(e,r){var n;return function OrderForm_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,OrderForm),(n=t.call(this,e)).events=r,n._submitBtn=ensureElement('.button[type="submit"]',n.container),n._errors=ensureElement(".form__errors",n.container),n.container.addEventListener("submit",(function(e){e.preventDefault(),n.onSubmit()})),n}return function OrderForm_createClass(e,t,r){return t&&OrderForm_defineProperties(e.prototype,t),r&&OrderForm_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(OrderForm,[{key:"onSubmit",value:function onSubmit(){}},{key:"isValid",set:function set(e){this.setDisable(this._submitBtn,!e)}},{key:"errors",set:function set(e){this.setText(this._errors,e)}},{key:"render",value:function render(e){return e&&(void 0!==e.isValid&&(this.isValid=e.isValid),void 0!==e.errors&&(this.errors=e.errors)),this.container}}]),OrderForm}(n);function PaymentForm_typeof(e){return PaymentForm_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},PaymentForm_typeof(e)}function PaymentForm_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function PaymentForm_toPrimitive(e,t){if("object"!==PaymentForm_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==PaymentForm_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===PaymentForm_typeof(i)?i:String(i)),n)}var o,i}function PaymentForm_setPrototypeOf(e,t){return PaymentForm_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e},PaymentForm_setPrototypeOf(e,t)}function PaymentForm_createSuper(e){var t=function PaymentForm_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var r,n=PaymentForm_getPrototypeOf(e);if(t){var o=PaymentForm_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function PaymentForm_possibleConstructorReturn(e,t){if(t&&("object"===PaymentForm_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function PaymentForm_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function PaymentForm_getPrototypeOf(e){return PaymentForm_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)},PaymentForm_getPrototypeOf(e)}var f=function(e){!function PaymentForm_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PaymentForm_setPrototypeOf(e,t)}(PaymentForm,e);var t=PaymentForm_createSuper(PaymentForm);function PaymentForm(e,r){var n;return function PaymentForm_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PaymentForm),(n=t.call(this,e,r))._addressInput=ensureElement('input[name="address"]',n.container),n._paymentBtns=ensureAllElements(".button_alt",n.container),n._addressInput.addEventListener("input",(function(){n.events.emit("order.address:change",{field:"address",value:n._addressInput.value})})),n._paymentBtns.forEach((function(e){e.addEventListener("click",(function(){n.events.emit("order.payment:change",{field:"payment",value:e.name})}))})),n}return function PaymentForm_createClass(e,t,r){return t&&PaymentForm_defineProperties(e.prototype,t),r&&PaymentForm_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(PaymentForm,[{key:"payment",set:function set(e){var t=this;this._paymentBtns.forEach((function(r){t.toggleClassName(r,"button_alt-active",r.name===e)}))}},{key:"address",set:function set(e){this._addressInput&&(this._addressInput.value=null!=e?e:"")}},{key:"onSubmit",value:function onSubmit(){this.events.emit("paymentForm:submit")}},{key:"render",value:function render(e){return e&&(e.payment&&(this.payment=e.payment),e.address&&(this.address=e.address),void 0!==e.isValid&&(this.isValid=e.isValid),void 0!==e.errors&&(this.errors=e.errors)),this.container}}]),PaymentForm}(l);function ContactsForm_typeof(e){return ContactsForm_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ContactsForm_typeof(e)}function ContactsForm_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function ContactsForm_toPrimitive(e,t){if("object"!==ContactsForm_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==ContactsForm_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===ContactsForm_typeof(i)?i:String(i)),n)}var o,i}function ContactsForm_setPrototypeOf(e,t){return ContactsForm_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e},ContactsForm_setPrototypeOf(e,t)}function ContactsForm_createSuper(e){var t=function ContactsForm_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var r,n=ContactsForm_getPrototypeOf(e);if(t){var o=ContactsForm_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function ContactsForm_possibleConstructorReturn(e,t){if(t&&("object"===ContactsForm_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function ContactsForm_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function ContactsForm_getPrototypeOf(e){return ContactsForm_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)},ContactsForm_getPrototypeOf(e)}var p=function(e){!function ContactsForm_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ContactsForm_setPrototypeOf(e,t)}(ContactsForm,e);var t=ContactsForm_createSuper(ContactsForm);function ContactsForm(e,r){var n;return function ContactsForm_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ContactsForm),(n=t.call(this,e,r))._emailInput=ensureElement('input[name="email"]',n.container),n._phoneInput=ensureElement('input[name="phone"]',n.container),n._emailInput.addEventListener("input",(function(){n.events.emit("order.email:change",{field:"email",value:n._emailInput.value})})),n._phoneInput.addEventListener("input",(function(){n.events.emit("order.phone:change",{field:"phone",value:n._phoneInput.value})})),n}return function ContactsForm_createClass(e,t,r){return t&&ContactsForm_defineProperties(e.prototype,t),r&&ContactsForm_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(ContactsForm,[{key:"email",set:function set(e){this._emailInput&&(this._emailInput.value=null!=e?e:"")}},{key:"phone",set:function set(e){this._phoneInput&&(this._phoneInput.value=null!=e?e:"")}},{key:"onSubmit",value:function onSubmit(){this.events.emit("order:submit")}},{key:"render",value:function render(e){return e&&(e.email&&(this.email=e.email),e.phone&&(this.phone=e.phone),void 0!==e.isValid&&(this.isValid=e.isValid),void 0!==e.errors&&(this.errors=e.errors)),this.container}}]),ContactsForm}(l),y=ensureElement("#card-catalog"),m=ensureElement("#card-preview"),d=ensureElement("#basket"),_=ensureElement("#order"),b=ensureElement("#contacts"),v=ensureElement("#success"),h=new t,P=new e("https://larek-api.nomoreparties.co/api/weblarek"),g=new r(h),O=new s(document.body,h),k=new o(cloneTemplate(d),h),S=new u(cloneTemplate(v),h),w=new f(cloneTemplate(_),h),C=new p(cloneTemplate(b),h);!function initApp(){!function modalPresenter(){h.on("modal:open",(function(e){e&&(O.renderModalOpen(e),O.locked=!0)})),h.on("modal:close",(function(){O.modalClose(),O.locked=!1}))}(),function catalogPresenter(){h.on("catalog:changed",(function(e){var t=e.map((function(e){var t=new i(cloneTemplate(y),{onClick:function onClick(){return h.emit("card:select",e)}}).render({title:e.title,image:e.image,price:e.price,category:e.category});return t.dataset.id=e.id,t}));O.catalog=t})),h.on("card:select",(function(e){var t=g.getBasket().some((function(t){return t.id===e.id})),r=new i(cloneTemplate(m),{onClick:function onClick(){t?(h.emit("basket:remove",{id:e.id}),h.emit("modal:close")):h.emit("basket:add",e)}}).render({title:e.title,image:e.image,price:e.price,category:e.category,description:e.description,inBasket:t});h.emit("modal:open",r)}))}(),function basketPresenter(){h.on("basket:changed",(function(){var e=g.getBasket(),t=e.map((function(e,t){return new c(cloneTemplate("#card-basket"),h).render({index:t+1,title:e.title,price:e.price,id:e.id})}));k.items=t,k.total=g.getTotal(),k.isEmpty=g.hasNoItems(),k.hasOnlyFreeItems=g.hasOnlyFreeItems(),O.counter=e.length})),h.on("basket:add",(function(e){g.addToBasket(e),h.emit("modal:close")})),h.on("basket:remove",(function(e){g.delFromBasket(e.id)})),h.on("basket:open",(function(){h.emit("modal:open",k.container)}))}(),function orderPresenter(){var e=w;h.on("order:open",(function(){var t=g.getOrder(),r=g.validateOrder("payment");e=w,w.render({payment:t.payment||"card",address:t.address||"",isValid:r.isValid,errors:r.errors}),h.emit("modal:open",w.container)})),h.on("paymentForm:submit",(function(){var t=g.getOrder(),r=g.validateOrder("contacts");e=C,C.render({email:t.email||"",phone:t.phone||"",isValid:r.isValid,errors:r.errors}),h.emit("modal:open",C.container)})),h.on("order:submit",(function(){var e=Object.assign(Object.assign({},g.getOrder()),{items:g.getPaidItems().map((function(e){return e.id})),total:g.getTotal()});P.post("/order",e).then((function(e){g.clearBasket(),S.total=e.total,h.emit("modal:open",S.container)})).catch((function(e){C.errors=e.message}))})),h.on(/^order\..*change/,(function(t){g.setOrderFormField(t.field,t.value);var r=g.getOrder();if(e===w){var n=g.validateOrder("payment");w.render({payment:r.payment,address:r.address,isValid:n.isValid,errors:n.errors})}else if(e===C){var o=g.validateOrder("contacts");C.render({email:r.email,phone:r.phone,isValid:o.isValid,errors:o.errors})}}))}(),P.get("/product").then((function(e){g.setCatalog(e.items)})).catch((function(e){console.error("Ошибка: не удалось загрузить каталог",e)}))}()})();
//# sourceMappingURL=main.js.map